{% extends 'base.html' %}

{% block meta %}

{# FB tags #}
<meta property="og:site_name"    content="{{app_name}}" />
<meta property="og:title"        content="{{book.title}} by {{', '.join(book.authors)}}" />
<meta property="og:url"          content="{{this_url}}" />
<meta property="og:image"        content="{{book.cover_url}}" />
<meta property="og:description"  content="" />
<meta property="og:type"         content="books.book" />
<meta property="books:author"    content="{{', '.join(book.authors)}}" />

{# Twitter tags #}
<meta name="twitter:card"        content="summary_large_image">
<meta name="twitter:site"        content="{{app_name}}">
<meta name="twitter:creator"     content="{{', '.join(book.authors)}}">
<meta name="twitter:title"       content="{{book.title}}">
<meta name="twitter:description" content="">
<meta name="twitter:image"       content="{{book.cover_url}}">

{% endblock %}

{% block header %}
<nav class="navbar">
  
  <div class="container-fluid">

    <div class="navbar-header">
      <a class="navbar-brand" href="/">
        <img id="home" alt="motw home" src="/static/motw.ico">
      </a>
    </div>

    <div class="collapse navbar-collapse">
      <p class="navbar-text"></p>
    </div>

  </div>
</nav>

{% endblock %}

{% block content %}
<div id="content" class="container"></div>
{% endblock %}

{% block templates %}
<script type="text/x-template" id="book-permalink-navbar-text-tmpl">
  <%= book.title %> :: <%= book.authors %>
</script>

<script type="text/x-template" id="book-permalink-tmpl">
  <div id="book-permalink" title="<%= book.title %>" class="container">
    <div class="row">
      <div class="col-md-8">

        <% for( var i = 0; i < properties.length; i++ ) { %>
        <div class="row property">
          <div class="col-md-2">
            <span class="attr"><%= properties[i].display_name %></span>
          </div>
          <div class="col-md-10"><%= book[properties[i].name] %></div>
        </div>
        <% } %>

        <% if (book.formats[0] != '0') { %>
        <div class="row property">
          <div class="col-md-2">
            <span class="attr">Download:</span>
          </div>
          <div class="col-md-10">
            <% for( var i = 0; i < book.formats.length; i++ ) { %>
               <% var format = book.formats[i] %>
               <a href="<%= book.prefix_url + book.format_metadata[format].file_path %>">
                 <%= format.toUpperCase() %>
               </a>
               <% } %>
          </div>
        </div>
        <% } %>

      </div>

      <div class="col-md-4">

        <img class="cover-permalink img-responsive" src="<%= book.cover_url %>" />
        
        <% if (localCalibre.showImportLinks(book.library_uuid)) { %>
        <a href="http://127.0.0.1:56665/?urls=<%= metadata_urls %>" class="import"
           title="import book directly to calibre" target="import">
          <span class="lodestone_modal">
            <img src="/images/lodestone.png" title="import book directly to calibre" />
          </span>
        </a>
        <% } %>
      </div>
    </div>
 
  </div>
</script>
{% endblock %}

{% block scripts %}
<script type="application/javascript" src="/static/b.js"></script>
{% endblock %}
